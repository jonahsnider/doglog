/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java library project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/8.0.2/userguide/building_java_projects.html
 */

plugins {
	// Apply the java-library plugin for API and implementation separation.
	id 'java-library'
	id "com.diffplug.spotless" version "7.1.0"
	id 'edu.wpi.first.wpilib.repositories.WPILibRepositoriesPlugin' version '2025.0'
	id 'maven-publish'
	id "net.ltgt.errorprone" version "4.3.0"
}

archivesBaseName = 'doglog'

tasks.withType(Javadoc) {
	options {
		docTitle = "DogLog Javadoc"
	}
}

// Error Prone configs
tasks.withType(JavaCompile).configureEach {
	options.errorprone.disable("InlineMeSuggester", "ImmutableEnumChecker", "Var", "BooleanParameter", "Java8ApiChecker", "AndroidJdkLibsChecker", "ImmutableMemberCollection", "ReturnMissingNullable", "FieldMissingNullable", "ParameterMissingNullable", "EqualsMissingNullable")

	// Set the ERRORPRONE_AUTOFIX environment variable to fix files in place
	if (System.getenv().containsKey("ERRORPRONE_AUTOFIX")) {
		options.errorprone.errorproneArgs.add "-XepPatchLocation:IN_PLACE"
	}
}

ext.wpilibVersion = "2025.+"

repositories {
	// Use Maven Central for resolving dependencies.
	mavenCentral()
}

if (project.hasProperty('releaseMode')) {
	wpilibRepositories.addAllReleaseRepositories(project)
} else {
	wpilibRepositories.addAllDevelopmentRepositories(project)
}

dependencies {
	implementation "edu.wpi.first.ntcore:ntcore-java:$wpilibVersion"
	implementation "edu.wpi.first.wpilibj:wpilibj-java:$wpilibVersion"
	implementation "edu.wpi.first.wpiutil:wpiutil-java:$wpilibVersion"
	implementation "edu.wpi.first.hal:hal-java:$wpilibVersion"
	implementation "edu.wpi.first.wpilibNewCommands:wpilibNewCommands-java:$wpilibVersion"

	errorprone "com.google.errorprone:error_prone_core:2.40.0"
}

publishing {
	publications {
		maven(MavenPublication) {
			from components.java
			groupId = "com.github.jonahsnider"
			artifactId = "doglog"
		}
	}
}

java {
	withSourcesJar()
	withJavadocJar()

	sourceCompatibility = JavaVersion.VERSION_17
	targetCompatibility = JavaVersion.VERSION_17
}
var javaVersion = "17"


javadoc {
	options {
		links "https://docs.oracle.com/en/java/javase/$javaVersion/docs/api/", 'https://github.wpilib.org/allwpilib/docs/release/java/'
	}
}

spotless {
	enforceCheck = false

	encoding = 'UTF-8'
	lineEndings = 'UNIX'

	java {
		googleJavaFormat('1.26.0')
		licenseHeader ''

		targetExclude('src/main/java/frc/robot/generated/BuildConstants.java')
	}

	groovyGradle {
		greclipse()
	}

	json {
		target '**/*.json'
		simple().indentWithSpaces(2)

		targetExclude('package.json')
	}
}
